<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AREA: README</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">AREA
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">README</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a href="https://travis-ci.org/dchester/jsonpath"><img src="https://travis-ci.org/dchester/jsonpath.png?branch=master" alt="Build Status" class="inline"/></a></p>
<h1><a class="anchor" id="autotoc_md16634"></a>
jsonpath</h1>
<p>Query JavaScript objects with JSONPath expressions. Robust / safe JSONPath engine for Node.js.</p>
<h2><a class="anchor" id="autotoc_md16635"></a>
Query Example</h2>
<div class="fragment"><div class="line">var cities = [</div>
<div class="line">  { name: &quot;London&quot;, &quot;population&quot;: 8615246 },</div>
<div class="line">  { name: &quot;Berlin&quot;, &quot;population&quot;: 3517424 },</div>
<div class="line">  { name: &quot;Madrid&quot;, &quot;population&quot;: 3165235 },</div>
<div class="line">  { name: &quot;Rome&quot;,   &quot;population&quot;: 2870528 }</div>
<div class="line">];</div>
<div class="line"> </div>
<div class="line">var jp = require(&#39;jsonpath&#39;);</div>
<div class="line">var names = jp.query(cities, &#39;$..name&#39;);</div>
<div class="line"> </div>
<div class="line">// [ &quot;London&quot;, &quot;Berlin&quot;, &quot;Madrid&quot;, &quot;Rome&quot; ]</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md16636"></a>
Install</h2>
<p>Install from npm: </p><div class="fragment"><div class="line">$ npm install jsonpath</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md16637"></a>
JSONPath Syntax</h2>
<p>Here are syntax and examples adapted from <a href="http://goessner.net/articles/JsonPath/">Stefan Goessner's original post</a> introducing JSONPath in 2007.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">JSONPath   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>$</code>   </td><td class="markdownTableBodyNone">The root object/element    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>@</code>   </td><td class="markdownTableBodyNone">The current object/element    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>.</code>   </td><td class="markdownTableBodyNone">Child member operator    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>..</code>   </td><td class="markdownTableBodyNone">Recursive descendant operator; JSONPath borrows this syntax from E4X    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>*</code>   </td><td class="markdownTableBodyNone">Wildcard matching all objects/elements regardless their names    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>[]</code>   </td><td class="markdownTableBodyNone">Subscript operator    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>[,]</code>   </td><td class="markdownTableBodyNone">Union operator for alternate names or array indices as a set    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>[start:end:step]</code>   </td><td class="markdownTableBodyNone">Array slice operator borrowed from ES4 / Python    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>?()</code>   </td><td class="markdownTableBodyNone">Applies a filter (script) expression via static evaluation    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>()</code>   </td><td class="markdownTableBodyNone">Script expression via static evaluation   </td></tr>
</table>
<p>Given this sample data set, see example expressions below:</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  &quot;store&quot;: {</div>
<div class="line">    &quot;book&quot;: [ </div>
<div class="line">      {</div>
<div class="line">        &quot;category&quot;: &quot;reference&quot;,</div>
<div class="line">        &quot;author&quot;: &quot;Nigel Rees&quot;,</div>
<div class="line">        &quot;title&quot;: &quot;Sayings of the Century&quot;,</div>
<div class="line">        &quot;price&quot;: 8.95</div>
<div class="line">      }, {</div>
<div class="line">        &quot;category&quot;: &quot;fiction&quot;,</div>
<div class="line">        &quot;author&quot;: &quot;Evelyn Waugh&quot;,</div>
<div class="line">        &quot;title&quot;: &quot;Sword of Honour&quot;,</div>
<div class="line">        &quot;price&quot;: 12.99</div>
<div class="line">      }, {</div>
<div class="line">        &quot;category&quot;: &quot;fiction&quot;,</div>
<div class="line">        &quot;author&quot;: &quot;Herman Melville&quot;,</div>
<div class="line">        &quot;title&quot;: &quot;Moby Dick&quot;,</div>
<div class="line">        &quot;isbn&quot;: &quot;0-553-21311-3&quot;,</div>
<div class="line">        &quot;price&quot;: 8.99</div>
<div class="line">      }, {</div>
<div class="line">         &quot;category&quot;: &quot;fiction&quot;,</div>
<div class="line">        &quot;author&quot;: &quot;J. R. R. Tolkien&quot;,</div>
<div class="line">        &quot;title&quot;: &quot;The Lord of the Rings&quot;,</div>
<div class="line">        &quot;isbn&quot;: &quot;0-395-19395-8&quot;,</div>
<div class="line">        &quot;price&quot;: 22.99</div>
<div class="line">      }</div>
<div class="line">    ],</div>
<div class="line">    &quot;bicycle&quot;: {</div>
<div class="line">      &quot;color&quot;: &quot;red&quot;,</div>
<div class="line">      &quot;price&quot;: 19.95</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><p>Example JSONPath expressions:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">JSONPath   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>$.store.book[*].author</code>   </td><td class="markdownTableBodyNone">The authors of all books in the store    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>$..author</code>   </td><td class="markdownTableBodyNone">All authors    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>$.store.*</code>   </td><td class="markdownTableBodyNone">All things in store, which are some books and a red bicycle    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>$.store..price</code>   </td><td class="markdownTableBodyNone">The price of everything in the store    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>$..book[2]</code>   </td><td class="markdownTableBodyNone">The third book    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>$..book[(@.length-1)]</code>   </td><td class="markdownTableBodyNone">The last book via script subscript    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>$..book[-1:]</code>   </td><td class="markdownTableBodyNone">The last book via slice    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>$..book[0,1]</code>   </td><td class="markdownTableBodyNone">The first two books via subscript union    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>$..book[:2]</code>   </td><td class="markdownTableBodyNone">The first two books via subscript array slice    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>$..book[?(@.isbn)]</code>   </td><td class="markdownTableBodyNone">Filter all books with isbn number    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>$..book[?(@.price&lt;10)]</code>   </td><td class="markdownTableBodyNone">Filter all books cheaper than 10    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>$..book[?(@.price==8.95)]</code>   </td><td class="markdownTableBodyNone">Filter all books that cost 8.95    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>$..book[?(@.price&lt;30 &amp;&amp; @.category=="fiction")]</code>   </td><td class="markdownTableBodyNone">Filter all fiction books cheaper than 30    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>$..*</code>   </td><td class="markdownTableBodyNone">All members of JSON structure   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md16638"></a>
Methods</h2>
<h4><a class="anchor" id="autotoc_md16639"></a>
jp.query(obj, pathExpression[, count])</h4>
<p>Find elements in <code>obj</code> matching <code>pathExpression</code>. Returns an array of elements that satisfy the provided JSONPath expression, or an empty array if none were matched. Returns only first <code>count</code> elements if specified.</p>
<div class="fragment"><div class="line">var authors = jp.query(data, &#39;$..author&#39;);</div>
<div class="line">// [ &#39;Nigel Rees&#39;, &#39;Evelyn Waugh&#39;, &#39;Herman Melville&#39;, &#39;J. R. R. Tolkien&#39; ]</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md16640"></a>
jp.paths(obj, pathExpression[, count])</h4>
<p>Find paths to elements in <code>obj</code> matching <code>pathExpression</code>. Returns an array of element paths that satisfy the provided JSONPath expression. Each path is itself an array of keys representing the location within <code>obj</code> of the matching element. Returns only first <code>count</code> paths if specified.</p>
<div class="fragment"><div class="line">var paths = jp.paths(data, &#39;$..author&#39;);</div>
<div class="line">// [</div>
<div class="line">//   [&#39;$&#39;, &#39;store&#39;, &#39;book&#39;, 0, &#39;author&#39;] },</div>
<div class="line">//   [&#39;$&#39;, &#39;store&#39;, &#39;book&#39;, 1, &#39;author&#39;] },</div>
<div class="line">//   [&#39;$&#39;, &#39;store&#39;, &#39;book&#39;, 2, &#39;author&#39;] },</div>
<div class="line">//   [&#39;$&#39;, &#39;store&#39;, &#39;book&#39;, 3, &#39;author&#39;] }</div>
<div class="line">// ]</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md16641"></a>
jp.nodes(obj, pathExpression[, count])</h4>
<p>Find elements and their corresponding paths in <code>obj</code> matching <code>pathExpression</code>. Returns an array of node objects where each node has a <code>path</code> containing an array of keys representing the location within <code>obj</code>, and a <code>value</code> pointing to the matched element. Returns only first <code>count</code> nodes if specified.</p>
<div class="fragment"><div class="line">var nodes = jp.nodes(data, &#39;$..author&#39;);</div>
<div class="line">// [</div>
<div class="line">//   { path: [&#39;$&#39;, &#39;store&#39;, &#39;book&#39;, 0, &#39;author&#39;], value: &#39;Nigel Rees&#39; },</div>
<div class="line">//   { path: [&#39;$&#39;, &#39;store&#39;, &#39;book&#39;, 1, &#39;author&#39;], value: &#39;Evelyn Waugh&#39; },</div>
<div class="line">//   { path: [&#39;$&#39;, &#39;store&#39;, &#39;book&#39;, 2, &#39;author&#39;], value: &#39;Herman Melville&#39; },</div>
<div class="line">//   { path: [&#39;$&#39;, &#39;store&#39;, &#39;book&#39;, 3, &#39;author&#39;], value: &#39;J. R. R. Tolkien&#39; }</div>
<div class="line">// ]</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md16642"></a>
jp.value(obj, pathExpression[, newValue])</h4>
<p>Returns the value of the first element matching <code>pathExpression</code>. If <code>newValue</code> is provided, sets the value of the first matching element and returns the new value.</p>
<h4><a class="anchor" id="autotoc_md16643"></a>
jp.parent(obj, pathExpression)</h4>
<p>Returns the parent of the first matching element.</p>
<h4><a class="anchor" id="autotoc_md16644"></a>
jp.apply(obj, pathExpression, fn)</h4>
<p>Runs the supplied function <code>fn</code> on each matching element, and replaces each matching element with the return value from the function. The function accepts the value of the matching element as its only parameter. Returns matching nodes with their updated values.</p>
<div class="fragment"><div class="line">var nodes = jp.apply(data, &#39;$..author&#39;, function(value) { return value.toUpperCase() });</div>
<div class="line">// [</div>
<div class="line">//   { path: [&#39;$&#39;, &#39;store&#39;, &#39;book&#39;, 0, &#39;author&#39;], value: &#39;NIGEL REES&#39; },</div>
<div class="line">//   { path: [&#39;$&#39;, &#39;store&#39;, &#39;book&#39;, 1, &#39;author&#39;], value: &#39;EVELYN WAUGH&#39; },</div>
<div class="line">//   { path: [&#39;$&#39;, &#39;store&#39;, &#39;book&#39;, 2, &#39;author&#39;], value: &#39;HERMAN MELVILLE&#39; },</div>
<div class="line">//   { path: [&#39;$&#39;, &#39;store&#39;, &#39;book&#39;, 3, &#39;author&#39;], value: &#39;J. R. R. TOLKIEN&#39; }</div>
<div class="line">// ]</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md16645"></a>
jp.parse(pathExpression)</h4>
<p>Parse the provided JSONPath expression into path components and their associated operations.</p>
<div class="fragment"><div class="line">var path = jp.parse(&#39;$..author&#39;);</div>
<div class="line">// [</div>
<div class="line">//   { expression: { type: &#39;root&#39;, value: &#39;$&#39; } },</div>
<div class="line">//   { expression: { type: &#39;identifier&#39;, value: &#39;author&#39; }, operation: &#39;member&#39;, scope: &#39;descendant&#39; }</div>
<div class="line">// ]</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md16646"></a>
jp.stringify(path)</h4>
<p>Returns a path expression in string form, given a path. The supplied path may either be a flat array of keys, as returned by <code>jp.nodes</code> for example, or may alternatively be a fully parsed path expression in the form of an array of path components as returned by <code>jp.parse</code>.</p>
<div class="fragment"><div class="line">var pathExpression = jp.stringify([&#39;$&#39;, &#39;store&#39;, &#39;book&#39;, 0, &#39;author&#39;]);</div>
<div class="line">// &quot;$.store.book[0].author&quot;</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md16647"></a>
Differences from Original Implementation</h2>
<p>This implementation aims to be compatible with Stefan Goessner's original implementation with a few notable exceptions described below.</p>
<h4><a class="anchor" id="autotoc_md16648"></a>
Evaluating Script Expressions</h4>
<p>Script expressions (i.e, <code>(...)</code> and <code>?(...)</code>) are statically evaluated via <a href="https://github.com/substack/static-eval">static-eval</a> rather than using the underlying script engine directly. That means both that the scope is limited to the instance variable (<code>@</code>), and only simple expressions (with no side effects) will be valid. So for example, <code>?(@.length&gt;10)</code> will be just fine to match arrays with more than ten elements, but <code>?(process.exit())</code> will not get evaluated since <code>process</code> would yield a <code>ReferenceError</code>. This method is even safer than <code>vm.runInNewContext</code>, since the script engine itself is more limited and entirely distinct from the one running the application code. See more details in the <a href="https://github.com/substack/static-eval/blob/master/index.js">implementation</a> of the evaluator.</p>
<h4><a class="anchor" id="autotoc_md16649"></a>
Grammar</h4>
<p>This project uses a formal BNF <a href="https://github.com/dchester/jsonpath/blob/master/lib/grammar.js">grammar</a> to parse JSONPath expressions, an attempt at reverse-engineering the intent of the original implementation, which parses via a series of creative regular expressions. The original regex approach can sometimes be forgiving for better or for worse (e.g., <code>$['store]</code> =&gt; &lsquo;$['store&rsquo;]<code>), and in other cases, can be just plain wrong (e.g.</code>[<code>=&gt;</code>$`).</p>
<h4><a class="anchor" id="autotoc_md16650"></a>
Other Minor Differences</h4>
<p>As a result of using a real parser and static evaluation, there are some arguable bugs in the original library that have not been carried through here:</p>
<ul>
<li>strings in subscripts may now be double-quoted</li>
<li>final <code>step</code> arguments in slice operators may now be negative</li>
<li>script expressions may now contain <code>.</code> and <code>@</code> characters not referring to instance variables</li>
<li>subscripts no longer act as character slices on string elements</li>
<li>non-ascii non-word characters are no-longer valid in member identifier names; use quoted subscript strings instead (e.g., &lsquo;$[&rsquo;$']<code>instead of</code>$.$`)</li>
<li>unions now yield real unions with no duplicates rather than concatenated results</li>
</ul>
<h2><a class="anchor" id="autotoc_md16651"></a>
License</h2>
<p>[MIT](LICENSE) </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
