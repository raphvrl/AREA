<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AREA: pretty-error</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">AREA
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">pretty-error</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md20610"></a> <a href="https://david-dm.org/AriaMinaei/pretty-error"><img src="https://david-dm.org/AriaMinaei/pretty-error.svg" alt="Dependency status" style="pointer-events: none;" class="inline"/></a> <a href="https://travis-ci.org/AriaMinaei/pretty-error"><img src="https://secure.travis-ci.org/AriaMinaei/pretty-error.svg?branch=master" alt="Build Status" style="pointer-events: none;" class="inline"/></a> <a href="https://npmjs.org/package/pretty-error"><img src="https://img.shields.io/npm/dm/pretty-error.svg" alt="npm" style="pointer-events: none;" class="inline"/></a></p>
<p>A small tool to see node.js errors with less clutter:</p>
<p><img src="https://github.com/AriaMinaei/pretty-error/raw/master/docs/images/pretty-error-screenshot.png" alt="screenshot of pretty-error" class="inline"/></p>
<p>... which is more readable compared to node's unformatted errors:</p>
<p><img src="https://github.com/AriaMinaei/pretty-error/raw/master/docs/images/normal-error-screenshot.png" alt="screenshot of normal errors" class="inline"/></p>
<h1><a class="anchor" id="autotoc_md20611"></a>
Installation</h1>
<p>Install with npm: </p><pre class="fragment">$ npm install pretty-error
</pre> <h1><a class="anchor" id="autotoc_md20612"></a>
Usage and Examples</h1>
<p>To see an error rendered with colors, you can do this:</p>
<div class="fragment"><div class="line">var PrettyError = require(&#39;pretty-error&#39;);</div>
<div class="line">var pe = new PrettyError();</div>
<div class="line"> </div>
<div class="line">var renderedError = pe.render(new Error(&#39;Some error message&#39;));</div>
<div class="line">console.log(renderedError);</div>
</div><!-- fragment --><p>Of course, you can render caught exceptions too:</p>
<div class="fragment"><div class="line">try {</div>
<div class="line">   doSomethingThatThrowsAnError();</div>
<div class="line">} catch (error) {</div>
<div class="line">   console.log(pe.render(error));</div>
<div class="line">}</div>
</div><!-- fragment --><p>But if you want pretty-error to render all errors, there is a shortcut for it:</p>
<div class="fragment"><div class="line">require(&#39;pretty-error&#39;).start();</div>
</div><!-- fragment --><p>... which is essentially equal to:</p>
<div class="fragment"><div class="line">var PrettyError = require(&#39;pretty-error&#39;);</div>
<div class="line"> </div>
<div class="line">// instantiate PrettyError, which can then be used to render error objects</div>
<div class="line">var pe = new PrettyError();</div>
<div class="line">pe.start();</div>
</div><!-- fragment --><p>You can also preload pretty-error into your code using node's <a href="https://nodejs.org/api/cli.html#cli_r_require_module"><code>--require</code></a> argument:</p>
<div class="fragment"><div class="line">$ node --require pretty-error/start your-module.js</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md20613"></a>
How it Works</h1>
<p>PrettyError turns error objects into something similar to an html document, and then uses <a href="https://github.com/AriaMinaei/renderkid">RenderKid</a> to render the document using simple html/css-like commands. This allows PrettyError to be themed using simple css-like declarations.</p>
<h1><a class="anchor" id="autotoc_md20614"></a>
Theming</h1>
<p>PrettyError's default theme is a bunch of simple css-like rules. <a href="https://github.com/AriaMinaei/pretty-error/blob/master/src/defaultStyle.coffee">Here</a> is the source of the default theme.</p>
<p>Since the default theme is all css, you can customize it to fit your taste. Let's do a minimal one:</p>
<div class="fragment"><div class="line">// the start() shortcut returns an instance of PrettyError ...</div>
<div class="line">pe = require(&#39;pretty-error&#39;).start();</div>
<div class="line"> </div>
<div class="line">// ... which we can then use to customize like this:</div>
<div class="line">pe.appendStyle({</div>
<div class="line">   // this is a simple selector to the element that says &#39;Error&#39;</div>
<div class="line">   &#39;pretty-error &gt; header &gt; title &gt; kind&#39;: {</div>
<div class="line">      // which we can hide:</div>
<div class="line">      display: &#39;none&#39;</div>
<div class="line">   },</div>
<div class="line"> </div>
<div class="line">   // the &#39;colon&#39; after &#39;Error&#39;:</div>
<div class="line">   &#39;pretty-error &gt; header &gt; colon&#39;: {</div>
<div class="line">      // we hide that too:</div>
<div class="line">      display: &#39;none&#39;</div>
<div class="line">   },</div>
<div class="line"> </div>
<div class="line">   // our error message</div>
<div class="line">   &#39;pretty-error &gt; header &gt; message&#39;: {</div>
<div class="line">      // let&#39;s change its color:</div>
<div class="line">      color: &#39;bright-white&#39;,</div>
<div class="line"> </div>
<div class="line">      // we can use black, red, green, yellow, blue, magenta, cyan, white,</div>
<div class="line">      // grey, bright-red, bright-green, bright-yellow, bright-blue,</div>
<div class="line">      // bright-magenta, bright-cyan, and bright-white</div>
<div class="line"> </div>
<div class="line">      // we can also change the background color:</div>
<div class="line">      background: &#39;cyan&#39;,</div>
<div class="line"> </div>
<div class="line">      // it understands paddings too!</div>
<div class="line">      padding: &#39;0 1&#39; // top/bottom left/right</div>
<div class="line">   },</div>
<div class="line"> </div>
<div class="line">   // each trace item ...</div>
<div class="line">   &#39;pretty-error &gt; trace &gt; item&#39;: {</div>
<div class="line">      // ... can have a margin ...</div>
<div class="line">      marginLeft: 2,</div>
<div class="line"> </div>
<div class="line">      // ... and a bullet character!</div>
<div class="line">      bullet: &#39;&quot;&lt;grey&gt;o&lt;/grey&gt;&quot;&#39;</div>
<div class="line"> </div>
<div class="line">      // Notes on bullets:</div>
<div class="line">      //</div>
<div class="line">      // The string inside the quotation mark gets used as the character</div>
<div class="line">      // to show for the bullet point.</div>
<div class="line">      //</div>
<div class="line">      // You can set its color/background color using tags.</div>
<div class="line">      //</div>
<div class="line">      // This example sets the background color to white, and the text color</div>
<div class="line">      // to cyan, the character will be a hyphen with a space character</div>
<div class="line">      // on each side:</div>
<div class="line">      // example: &#39;&quot;&lt;bg-white&gt;&lt;cyan&gt; - &lt;/cyan&gt;&lt;/bg-white&gt;&quot;&#39;</div>
<div class="line">      //</div>
<div class="line">      // Note that we should use a margin of 3, since the bullet will be</div>
<div class="line">      // 3 characters long.</div>
<div class="line">   },</div>
<div class="line"> </div>
<div class="line">   &#39;pretty-error &gt; trace &gt; item &gt; header &gt; pointer &gt; file&#39;: {</div>
<div class="line">      color: &#39;bright-cyan&#39;</div>
<div class="line">   },</div>
<div class="line"> </div>
<div class="line">   &#39;pretty-error &gt; trace &gt; item &gt; header &gt; pointer &gt; colon&#39;: {</div>
<div class="line">      color: &#39;cyan&#39;</div>
<div class="line">   },</div>
<div class="line"> </div>
<div class="line">   &#39;pretty-error &gt; trace &gt; item &gt; header &gt; pointer &gt; line&#39;: {</div>
<div class="line">      color: &#39;bright-cyan&#39;</div>
<div class="line">   },</div>
<div class="line"> </div>
<div class="line">   &#39;pretty-error &gt; trace &gt; item &gt; header &gt; what&#39;: {</div>
<div class="line">      color: &#39;bright-white&#39;</div>
<div class="line">   },</div>
<div class="line"> </div>
<div class="line">   &#39;pretty-error &gt; trace &gt; item &gt; footer &gt; addr&#39;: {</div>
<div class="line">      display: &#39;none&#39;</div>
<div class="line">   }</div>
<div class="line">});</div>
</div><!-- fragment --><p>This is how our minimal theme will look like: <img src="https://github.com/AriaMinaei/pretty-error/raw/master/docs/images/custom-theme-screenshot.png" alt="screenshot of our custom theme" class="inline"/></p>
<p>Read <a href="https://github.com/AriaMinaei/renderkid">RenderKid</a>'s docs to learn about all the css rules that are supported.</p>
<h1><a class="anchor" id="autotoc_md20615"></a>
Customization</h1>
<p>There are a few methods to help you customize the contents of your error logs.</p>
<p>Let's instantiate first:</p>
<div class="fragment"><div class="line">PrettyError = require(&#39;pretty-error&#39;);</div>
<div class="line">pe = new PrettyError();</div>
<div class="line"> </div>
<div class="line">// or:</div>
<div class="line">pe = require(&#39;pretty-error&#39;).start();</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md20616"></a>
Shortening paths</h3>
<p>You might want to substitute long paths with shorter, more readable aliases:</p>
<div class="fragment"><div class="line">pe.alias(&#39;E:/open-source/theatrejs/lib&#39;, &#39;(Theatre.js)&#39;);</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md20617"></a>
Skipping packages</h3>
<p>You might want to skip trace lines that belong to specific packages (chai, when, socket.io):</p>
<div class="fragment"><div class="line">pe.skipPackage(&#39;chai&#39;, &#39;when&#39;, &#39;socket.io&#39;);</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md20618"></a>
Skipping node files</h3>
<div class="fragment"><div class="line">// this will skip node.js, path.js, event.js, etc.</div>
<div class="line">pe.skipNodeFiles();</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md20619"></a>
Skipping paths</h3>
<div class="fragment"><div class="line">pe.skipPath(&#39;/home/dir/someFile.js&#39;);</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md20620"></a>
Skipping by callback</h3>
<p>You can customize which trace lines get logged and which won't: </p><div class="fragment"><div class="line">pe.skip(function(traceLine, lineNumber){</div>
<div class="line">   // if we know which package this trace line comes from, and it isn&#39;t</div>
<div class="line">   // our &#39;demo&#39; package ...</div>
<div class="line">   if (typeof traceLine.packageName !== &#39;undefined&#39; &amp;&amp; traceLine.packageName !== &#39;demo&#39;) {</div>
<div class="line">      // then skip this line</div>
<div class="line">      return true;</div>
<div class="line">   }</div>
<div class="line"> </div>
<div class="line">   // You can console.log(traceLine) to see all of it&#39;s properties.</div>
<div class="line">   // Don&#39;t expect all these properties to be present, and don&#39;t assume</div>
<div class="line">   // that our traceLine is always an object.</div>
<div class="line">});</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md20621"></a>
Modifying each trace line's contents</h3>
<div class="fragment"><div class="line">pe.filter(function(traceLine, lineNumber){</div>
<div class="line">   // the &#39;what&#39; clause is something like:</div>
<div class="line">   // &#39;DynamicTimeline.module.exports.DynamicTimeline._verifyProp&#39;</div>
<div class="line">   if (typeof traceLine.what !== &#39;undefined&#39;){</div>
<div class="line"> </div>
<div class="line">      // we can shorten it with a regex:</div>
<div class="line">      traceLine.what = traceLine.what.replace(</div>
<div class="line">         /(.*\.module\.exports\.)(.*)/, &#39;$2&#39;</div>
<div class="line">      );</div>
<div class="line">   }</div>
<div class="line">});</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md20622"></a>
Disabling colors</h1>
<div class="fragment"><div class="line">pe.withoutColors(); // Errors will be rendered without coloring</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md20623"></a>
Integrating with frameworks</h1>
<p>PrettyError is very simple to set up, so it should be easy to use within other frameworks.</p>
<h2><a class="anchor" id="autotoc_md20624"></a>
Integrating with <a href="https://github.com/visionmedia/express">express</a></h2>
<p>Most frameworks such as express, catch errors automatically and provide a mechanism to handle those errors. Here is an example of how you can use PrettyError to log unhandled errors in express:</p>
<div class="fragment"><div class="line">// this is app.js</div>
<div class="line"> </div>
<div class="line">var express = require(&#39;express&#39;);</div>
<div class="line">var PrettyError = require(&#39;pretty-error&#39;);</div>
<div class="line"> </div>
<div class="line">var app = express();</div>
<div class="line"> </div>
<div class="line">app.get(&#39;/&#39;, function(req, res) {</div>
<div class="line">   // this will throw an error:</div>
<div class="line">   var a = b;</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line">var server = app.listen(3000, function(){</div>
<div class="line">   console.log(&#39;Server started \n&#39;);</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">// we can now instantiaite Prettyerror:</div>
<div class="line">pe = new PrettyError();</div>
<div class="line"> </div>
<div class="line">// and use it for our app&#39;s error handler:</div>
<div class="line">app.use(function(err, req, res, next){</div>
<div class="line">   console.log(pe.render(err));</div>
<div class="line">   next();</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line">// we can optionally configure prettyError to simplify the stack trace:</div>
<div class="line"> </div>
<div class="line">pe.skipNodeFiles(); // this will skip events.js and http.js and similar core node files</div>
<div class="line">pe.skipPackage(&#39;express&#39;); // this will skip all the trace lines about express` core and sub-modules</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md20625"></a>
Troubleshooting</h1>
<p><code>PrettyError.start()</code> modifies the stack traces of all errors thrown anywhere in your code, so it could potentially break packages that rely on node's original stack traces. I've only encountered this problem once, and it was with BlueBird when <code>Promise.longStackTraces()</code> was on.</p>
<p>In order to avoid this problem, it's better to not use <code>PrettyError.start()</code> and instead, manually catch errors and render them with PrettyError:</p>
<div class="fragment"><div class="line">var PrettyError = require(&#39;pretty-error&#39;);</div>
<div class="line">var pe = new PrettyError();</div>
<div class="line"> </div>
<div class="line">// To render exceptions thrown in non-promies code:</div>
<div class="line">process.on(&#39;uncaughtException&#39;, function(error){</div>
<div class="line">   console.log(pe.render(error));</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line">// To render unhandled rejections created in BlueBird:</div>
<div class="line">process.on(&#39;unhandledRejection&#39;, function(reason){</div>
<div class="line">   console.log(&quot;Unhandled rejection&quot;);</div>
<div class="line">   console.log(pe.render(reason));</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line">// While PrettyError.start() works out of the box with when.js` unhandled rejections,</div>
<div class="line">// now that wer&#39;e manually rendering errors, we have to instead use npmjs.org/packages/pretty-monitor</div>
<div class="line">// to handle when.js rejections.</div>
</div><!-- fragment --><p>The only drawback with this approach is that exceptions thrown in the first tick are not prettified. To fix that, you can delay your application's startup for one tick:</p>
<div class="fragment"><div class="line">// (continued form above)</div>
<div class="line"> </div>
<div class="line">throw new Error(); // not prettified</div>
<div class="line">process.nextTick(function(){</div>
<div class="line">   throw new Error(); // prettified</div>
<div class="line">});</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md20626"></a>
License</h1>
<p>MIT </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
