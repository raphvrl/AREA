<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AREA: htmlparser2</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">AREA
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">htmlparser2</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md14206"></a> <a href="https://npmjs.org/package/htmlparser2"><img src="http://img.shields.io/npm/v/htmlparser2.svg?style=flat" alt="NPM version" style="pointer-events: none;" class="inline"/></a> <a href="https://npmjs.org/package/htmlparser2"><img src="https://img.shields.io/npm/dm/htmlparser2.svg?style=flat" alt="Downloads" style="pointer-events: none;" class="inline"/></a> <a href="https://github.com/fb55/htmlparser2/actions?query=workflow%3A%22Node.js+Test%22"><img src="https://img.shields.io/github/workflow/status/fb55/htmlparser2/Node.js%20Test?label=tests&amp;style=flat" alt="Build Status" class="inline"/></a> <a href="https://coveralls.io/r/fb55/htmlparser2"><img src="http://img.shields.io/coveralls/fb55/htmlparser2.svg?style=flat" alt="Coverage" style="pointer-events: none;" class="inline"/></a></p>
<p>The fast &amp; forgiving HTML/XML parser.</p>
<h1><a class="anchor" id="autotoc_md14207"></a>
Installation</h1>
<pre class="fragment">npm install htmlparser2
</pre><p> A live demo of <code>htmlparser2</code> is available <a href="https://astexplorer.net/#/2AmVrGuGVJ">here</a>.</p>
<h1><a class="anchor" id="autotoc_md14208"></a>
Ecosystem</h1>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Name   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a href="https://github.com/fb55/htmlparser2">htmlparser2</a>   </td><td class="markdownTableBodyNone">Fast &amp; forgiving HTML/XML parser    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a href="https://github.com/fb55/domhandler">domhandler</a>   </td><td class="markdownTableBodyNone">Handler for htmlparser2 that turns documents into a DOM    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a href="https://github.com/fb55/domutils">domutils</a>   </td><td class="markdownTableBodyNone">Utilities for working with domhandler's DOM    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a href="https://github.com/fb55/css-select">css-select</a>   </td><td class="markdownTableBodyNone">CSS selector engine, compatible with domhandler's DOM    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a href="https://github.com/cheeriojs/cheerio">cheerio</a>   </td><td class="markdownTableBodyNone">The jQuery API for domhandler's DOM    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a href="https://github.com/cheeriojs/dom-serializer">dom-serializer</a>   </td><td class="markdownTableBodyNone">Serializer for domhandler's DOM   </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md14209"></a>
Usage</h1>
<p><code>htmlparser2</code> itself provides a callback interface that allows consumption of documents with minimal allocations. For a more ergonomic experience, read Getting a DOM below.</p>
<div class="fragment"><div class="line">const htmlparser2 = require(&quot;htmlparser2&quot;);</div>
<div class="line">const parser = new htmlparser2.Parser({</div>
<div class="line">    onopentag(name, attributes) {</div>
<div class="line">        /*</div>
<div class="line">         * This fires when a new tag is opened.</div>
<div class="line">         *</div>
<div class="line">         * If you don&#39;t need an aggregated `attributes` object,</div>
<div class="line">         * have a look at the `onopentagname` and `onattribute` events.</div>
<div class="line">         */</div>
<div class="line">        if (name === &quot;script&quot; &amp;&amp; attributes.type === &quot;text/javascript&quot;) {</div>
<div class="line">            console.log(&quot;JS! Hooray!&quot;);</div>
<div class="line">        }</div>
<div class="line">    },</div>
<div class="line">    ontext(text) {</div>
<div class="line">        /*</div>
<div class="line">         * Fires whenever a section of text was processed.</div>
<div class="line">         *</div>
<div class="line">         * Note that this can fire at any point within text and you might</div>
<div class="line">         * have to stich together multiple pieces.</div>
<div class="line">         */</div>
<div class="line">        console.log(&quot;--&gt;&quot;, text);</div>
<div class="line">    },</div>
<div class="line">    onclosetag(tagname) {</div>
<div class="line">        /*</div>
<div class="line">         * Fires when a tag is closed.</div>
<div class="line">         *</div>
<div class="line">         * You can rely on this event only firing when you have received an</div>
<div class="line">         * equivalent opening tag before. Closing tags without corresponding</div>
<div class="line">         * opening tags will be ignored.</div>
<div class="line">         */</div>
<div class="line">        if (tagname === &quot;script&quot;) {</div>
<div class="line">            console.log(&quot;That&#39;s it?!&quot;);</div>
<div class="line">        }</div>
<div class="line">    },</div>
<div class="line">});</div>
<div class="line">parser.write(</div>
<div class="line">    &quot;Xyz &lt;script type=&#39;text/javascript&#39;&gt;const foo = &#39;&lt;&lt;bar&gt;&gt;&#39;;&lt;/ script&gt;&quot;</div>
<div class="line">);</div>
<div class="line">parser.end();</div>
</div><!-- fragment --><p>Output (with multiple text events combined):</p>
<div class="fragment"><div class="line">--&gt; Xyz</div>
<div class="line">JS! Hooray!</div>
<div class="line">--&gt; const foo = &#39;&lt;&lt;bar&gt;&gt;&#39;;</div>
<div class="line">That&#39;s it?!</div>
</div><!-- fragment --><p>This example only shows three of the possible events. Read more about the parser, its events and options in the <a href="https://github.com/fb55/htmlparser2/wiki/Parser-options">wiki</a>.</p>
<h2><a class="anchor" id="autotoc_md14210"></a>
Usage with streams</h2>
<p>While the <code>Parser</code> interface closely resembles Node.js streams, it's not a 100% match. Use the <code>WritableStream</code> interface to process a streaming input:</p>
<div class="fragment"><div class="line">const { WritableStream } = require(&quot;htmlparser2/lib/WritableStream&quot;);</div>
<div class="line">const parserStream = new WritableStream({</div>
<div class="line">    ontext(text) {</div>
<div class="line">        console.log(&quot;Streaming:&quot;, text);</div>
<div class="line">    },</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line">const htmlStream = fs.createReadStream(&quot;./my-file.html&quot;);</div>
<div class="line">htmlStream.pipe(parserStream).on(&quot;finish&quot;, () =&gt; console.log(&quot;done&quot;));</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md14211"></a>
Getting a DOM</h1>
<p>The <code>DomHandler</code> produces a DOM (document object model) that can be manipulated using the <a href="https://github.com/fb55/DomUtils"><code>DomUtils</code></a> helper.</p>
<div class="fragment"><div class="line">const htmlparser2 = require(&quot;htmlparser2&quot;);</div>
<div class="line"> </div>
<div class="line">const dom = htmlparser2.parseDocument();</div>
</div><!-- fragment --><p>The <code>DomHandler</code>, while still bundled with this module, was moved to its <a href="https://github.com/fb55/domhandler">own module</a>. Have a look at that for further information.</p>
<h1><a class="anchor" id="autotoc_md14212"></a>
Parsing RSS/RDF/Atom Feeds</h1>
<div class="fragment"><div class="line">const feed = htmlparser2.parseFeed(content, options);</div>
</div><!-- fragment --><p>Note: While the provided feed handler works for most feeds, you might want to use <a href="https://github.com/danmactough/node-feedparser">danmactough/node-feedparser</a>, which is much better tested and actively maintained.</p>
<h1><a class="anchor" id="autotoc_md14213"></a>
Performance</h1>
<p>After having some artificial benchmarks for some time, <b>@AndreasMadsen</b> published his <a href="https://github.com/AndreasMadsen/htmlparser-benchmark"><code>htmlparser-benchmark</code></a>, which benchmarks HTML parses based on real-world websites.</p>
<p>At the time of writing, the latest versions of all supported parsers show the following performance characteristics on <a href="https://travis-ci.org/AndreasMadsen/htmlparser-benchmark/builds/10805007">Travis CI</a> (please note that Travis doesn't guarantee equal conditions for all tests):</p>
<div class="fragment"><div class="line">gumbo-parser   : 34.9208 ms/file ± 21.4238</div>
<div class="line">html-parser    : 24.8224 ms/file ± 15.8703</div>
<div class="line">html5          : 419.597 ms/file ± 264.265</div>
<div class="line">htmlparser     : 60.0722 ms/file ± 384.844</div>
<div class="line">htmlparser2-dom: 12.0749 ms/file ± 6.49474</div>
<div class="line">htmlparser2    : 7.49130 ms/file ± 5.74368</div>
<div class="line">hubbub         : 30.4980 ms/file ± 16.4682</div>
<div class="line">libxmljs       : 14.1338 ms/file ± 18.6541</div>
<div class="line">parse5         : 22.0439 ms/file ± 15.3743</div>
<div class="line">sax            : 49.6513 ms/file ± 26.6032</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md14214"></a>
How does this module differ from <a href="https://github.com/tautologistics/node-htmlparser">node-htmlparser</a>?</h1>
<p>This module started as a fork of the <code>htmlparser</code> module. The main difference is that <code>htmlparser2</code> is intended to be used only with node (it runs on other platforms using <a href="https://github.com/substack/node-browserify">browserify</a>). <code>htmlparser2</code> was rewritten multiple times and, while it maintains an API that's compatible with <code>htmlparser</code> in most cases, the projects don't share any code anymore.</p>
<p>The parser now provides a callback interface inspired by <a href="https://github.com/isaacs/sax-js">sax.js</a> (originally targeted at <a href="https://github.com/fb55/readabilitysax">readabilitySAX</a>). As a result, old handlers won't work anymore.</p>
<p>The <code>DefaultHandler</code> and the <code>RssHandler</code> were renamed to clarify their purpose (to <code>DomHandler</code> and <code>FeedHandler</code>). The old names are still available when requiring <code>htmlparser2</code>, your code should work as expected.</p>
<h1><a class="anchor" id="autotoc_md14215"></a>
Security contact information</h1>
<p>To report a security vulnerability, please use the <a href="https://tidelift.com/security">Tidelift security contact</a>. Tidelift will coordinate the fix and disclosure.</p>
<h1><a class="anchor" id="autotoc_md14216"></a>
<code>htmlparser2</code> for enterprise</h1>
<p>Available as part of the Tidelift Subscription</p>
<p>The maintainers of <code>htmlparser2</code> and thousands of other packages are working with Tidelift to deliver commercial support and maintenance for the open source dependencies you use to build your applications. Save time, reduce risk, and improve code health, while paying the maintainers of the exact dependencies you use. <a href="https://tidelift.com/subscription/pkg/npm-htmlparser2?utm_source=npm-htmlparser2&amp;utm_medium=referral&amp;utm_campaign=enterprise&amp;utm_term=repo">Learn more.</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
